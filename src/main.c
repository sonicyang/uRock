/**
  ******************************************************************************
  * File Name          : main.c
  * Date               : 29/04/2015 21:52:52
  * Description        : Main program body
  ******************************************************************************
  *
  * COPYRIGHT(c) 2015 STMicroelectronics
  *
  * Redistribution and use in source and binary forms, with or without modification,
  * are permitted provided that the following conditions are met:
  *   1. Redistributions of source code must retain the above copyright notice,
  *      this list of conditions and the following disclaimer.
  *   2. Redistributions in binary form must reproduce the above copyright notice,
  *      this list of conditions and the following disclaimer in the documentation
  *      and/or other materials provided with the distribution.
  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  *      may be used to endorse or promote products derived from this software
  *      without specific prior written permission.
  *
  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
  ******************************************************************************
  */

/* Includes ------------------------------------------------------------------*/
#include "stm32f4xx_hal.h"
#include "cmsis_os.h"

/* USER CODE BEGIN Includes */

/* USER CODE END Includes */

/* Private variables ---------------------------------------------------------*/
SAI_HandleTypeDef hsai_BlockA1;
SAI_HandleTypeDef hsai_BlockB1;
DMA_HandleTypeDef hdma_sai1_a;
DMA_HandleTypeDef hdma_sai1_b;

osThreadId defaultTaskHandle;

/* USER CODE BEGIN PV */
uint16_t sineTable[1024] = {0x8000,0x80c9,0x8192,0x825b,0x8324,0x83ed,0x84b6,0x857e,
0x8647,0x8710,0x87d9,0x88a1,0x896a,0x8a32,0x8afb,0x8bc3,
0x8c8b,0x8d53,0x8e1b,0x8ee3,0x8fab,0x9072,0x9139,0x9201,
0x92c7,0x938e,0x9455,0x951b,0x95e1,0x96a7,0x976d,0x9833,
0x98f8,0x99bd,0x9a82,0x9b47,0x9c0b,0x9ccf,0x9d93,0x9e56,
0x9f19,0x9fdc,0xa09f,0xa161,0xa223,0xa2e5,0xa3a6,0xa467,
0xa527,0xa5e8,0xa6a7,0xa767,0xa826,0xa8e5,0xa9a3,0xaa61,
0xab1f,0xabdc,0xac98,0xad55,0xae10,0xaecc,0xaf87,0xb041,
0xb0fb,0xb1b5,0xb26e,0xb326,0xb3de,0xb496,0xb54d,0xb603,
0xb6b9,0xb76f,0xb824,0xb8d8,0xb98c,0xba3f,0xbaf2,0xbba4,
0xbc56,0xbd07,0xbdb7,0xbe67,0xbf17,0xbfc5,0xc073,0xc121,
0xc1cd,0xc279,0xc325,0xc3d0,0xc47a,0xc524,0xc5cc,0xc675,
0xc71c,0xc7c3,0xc869,0xc90f,0xc9b3,0xca57,0xcafb,0xcb9d,
0xcc3f,0xcce0,0xcd81,0xce20,0xcebf,0xcf5d,0xcffb,0xd097,
0xd133,0xd1ce,0xd268,0xd302,0xd39a,0xd432,0xd4c9,0xd55f,
0xd5f5,0xd689,0xd71d,0xd7b0,0xd842,0xd8d3,0xd964,0xd9f3,
0xda82,0xdb0f,0xdb9c,0xdc28,0xdcb3,0xdd3d,0xddc7,0xde4f,
0xded7,0xdf5d,0xdfe3,0xe068,0xe0eb,0xe16e,0xe1f0,0xe271,
0xe2f1,0xe370,0xe3ee,0xe46b,0xe4e8,0xe563,0xe5dd,0xe656,
0xe6cf,0xe746,0xe7bc,0xe831,0xe8a6,0xe919,0xe98b,0xe9fc,
0xea6d,0xeadc,0xeb4a,0xebb7,0xec23,0xec8e,0xecf8,0xed61,
0xedc9,0xee30,0xee96,0xeefa,0xef5e,0xefc1,0xf022,0xf083,
0xf0e2,0xf140,0xf19d,0xf1f9,0xf254,0xf2ae,0xf307,0xf35e,
0xf3b5,0xf40a,0xf45f,0xf4b2,0xf504,0xf555,0xf5a5,0xf5f3,
0xf641,0xf68d,0xf6d8,0xf722,0xf76b,0xf7b3,0xf7fa,0xf83f,
0xf884,0xf8c7,0xf909,0xf94a,0xf989,0xf9c8,0xfa05,0xfa41,
0xfa7c,0xfab6,0xfaee,0xfb26,0xfb5c,0xfb91,0xfbc5,0xfbf8,
0xfc29,0xfc59,0xfc88,0xfcb6,0xfce3,0xfd0e,0xfd39,0xfd62,
0xfd89,0xfdb0,0xfdd5,0xfdfa,0xfe1d,0xfe3e,0xfe5f,0xfe7e,
0xfe9c,0xfeb9,0xfed5,0xfeef,0xff09,0xff21,0xff37,0xff4d,
0xff61,0xff74,0xff86,0xff97,0xffa6,0xffb4,0xffc1,0xffcd,
0xffd8,0xffe1,0xffe9,0xfff0,0xfff5,0xfff9,0xfffd,0xfffe,
0xffff,0xfffe,0xfffd,0xfff9,0xfff5,0xfff0,0xffe9,0xffe1,
0xffd8,0xffcd,0xffc1,0xffb4,0xffa6,0xff97,0xff86,0xff74,
0xff61,0xff4d,0xff37,0xff21,0xff09,0xfeef,0xfed5,0xfeb9,
0xfe9c,0xfe7e,0xfe5f,0xfe3e,0xfe1d,0xfdfa,0xfdd5,0xfdb0,
0xfd89,0xfd62,0xfd39,0xfd0e,0xfce3,0xfcb6,0xfc88,0xfc59,
0xfc29,0xfbf8,0xfbc5,0xfb91,0xfb5c,0xfb26,0xfaee,0xfab6,
0xfa7c,0xfa41,0xfa05,0xf9c8,0xf989,0xf94a,0xf909,0xf8c7,
0xf884,0xf83f,0xf7fa,0xf7b3,0xf76b,0xf722,0xf6d8,0xf68d,
0xf641,0xf5f3,0xf5a5,0xf555,0xf504,0xf4b2,0xf45f,0xf40a,
0xf3b5,0xf35e,0xf307,0xf2ae,0xf254,0xf1f9,0xf19d,0xf140,
0xf0e2,0xf083,0xf022,0xefc1,0xef5e,0xeefa,0xee96,0xee30,
0xedc9,0xed61,0xecf8,0xec8e,0xec23,0xebb7,0xeb4a,0xeadc,
0xea6d,0xe9fc,0xe98b,0xe919,0xe8a6,0xe831,0xe7bc,0xe746,
0xe6cf,0xe656,0xe5dd,0xe563,0xe4e8,0xe46b,0xe3ee,0xe370,
0xe2f1,0xe271,0xe1f0,0xe16e,0xe0eb,0xe068,0xdfe3,0xdf5d,
0xded7,0xde4f,0xddc7,0xdd3d,0xdcb3,0xdc28,0xdb9c,0xdb0f,
0xda82,0xd9f3,0xd964,0xd8d3,0xd842,0xd7b0,0xd71d,0xd689,
0xd5f5,0xd55f,0xd4c9,0xd432,0xd39a,0xd302,0xd268,0xd1ce,
0xd133,0xd097,0xcffb,0xcf5d,0xcebf,0xce20,0xcd81,0xcce0,
0xcc3f,0xcb9d,0xcafb,0xca57,0xc9b3,0xc90f,0xc869,0xc7c3,
0xc71c,0xc675,0xc5cc,0xc524,0xc47a,0xc3d0,0xc325,0xc279,
0xc1cd,0xc121,0xc073,0xbfc5,0xbf17,0xbe67,0xbdb7,0xbd07,
0xbc56,0xbba4,0xbaf2,0xba3f,0xb98c,0xb8d8,0xb824,0xb76f,
0xb6b9,0xb603,0xb54d,0xb496,0xb3de,0xb326,0xb26e,0xb1b5,
0xb0fb,0xb041,0xaf87,0xaecc,0xae10,0xad55,0xac98,0xabdc,
0xab1f,0xaa61,0xa9a3,0xa8e5,0xa826,0xa767,0xa6a7,0xa5e8,
0xa527,0xa467,0xa3a6,0xa2e5,0xa223,0xa161,0xa09f,0x9fdc,
0x9f19,0x9e56,0x9d93,0x9ccf,0x9c0b,0x9b47,0x9a82,0x99bd,
0x98f8,0x9833,0x976d,0x96a7,0x95e1,0x951b,0x9455,0x938e,
0x92c7,0x9201,0x9139,0x9072,0x8fab,0x8ee3,0x8e1b,0x8d53,
0x8c8b,0x8bc3,0x8afb,0x8a32,0x896a,0x88a1,0x87d9,0x8710,
0x8647,0x857e,0x84b6,0x83ed,0x8324,0x825b,0x8192,0x80c9,
0x8000,0x7f36,0x7e6d,0x7da4,0x7cdb,0x7c12,0x7b49,0x7a81,
0x79b8,0x78ef,0x7826,0x775e,0x7695,0x75cd,0x7504,0x743c,
0x7374,0x72ac,0x71e4,0x711c,0x7054,0x6f8d,0x6ec6,0x6dfe,
0x6d38,0x6c71,0x6baa,0x6ae4,0x6a1e,0x6958,0x6892,0x67cc,
0x6707,0x6642,0x657d,0x64b8,0x63f4,0x6330,0x626c,0x61a9,
0x60e6,0x6023,0x5f60,0x5e9e,0x5ddc,0x5d1a,0x5c59,0x5b98,
0x5ad8,0x5a17,0x5958,0x5898,0x57d9,0x571a,0x565c,0x559e,
0x54e0,0x5423,0x5367,0x52aa,0x51ef,0x5133,0x5078,0x4fbe,
0x4f04,0x4e4a,0x4d91,0x4cd9,0x4c21,0x4b69,0x4ab2,0x49fc,
0x4946,0x4890,0x47db,0x4727,0x4673,0x45c0,0x450d,0x445b,
0x43a9,0x42f8,0x4248,0x4198,0x40e8,0x403a,0x3f8c,0x3ede,
0x3e32,0x3d86,0x3cda,0x3c2f,0x3b85,0x3adb,0x3a33,0x398a,
0x38e3,0x383c,0x3796,0x36f0,0x364c,0x35a8,0x3504,0x3462,
0x33c0,0x331f,0x327e,0x31df,0x3140,0x30a2,0x3004,0x2f68,
0x2ecc,0x2e31,0x2d97,0x2cfd,0x2c65,0x2bcd,0x2b36,0x2aa0,
0x2a0a,0x2976,0x28e2,0x284f,0x27bd,0x272c,0x269b,0x260c,
0x257d,0x24f0,0x2463,0x23d7,0x234c,0x22c2,0x2238,0x21b0,
0x2128,0x20a2,0x201c,0x1f97,0x1f14,0x1e91,0x1e0f,0x1d8e,
0x1d0e,0x1c8f,0x1c11,0x1b94,0x1b17,0x1a9c,0x1a22,0x19a9,
0x1930,0x18b9,0x1843,0x17ce,0x1759,0x16e6,0x1674,0x1603,
0x1592,0x1523,0x14b5,0x1448,0x13dc,0x1371,0x1307,0x129e,
0x1236,0x11cf,0x1169,0x1105,0x10a1,0x103e,0xfdd,0xf7c,
0xf1d,0xebf,0xe62,0xe06,0xdab,0xd51,0xcf8,0xca1,
0xc4a,0xbf5,0xba0,0xb4d,0xafb,0xaaa,0xa5a,0xa0c,
0x9be,0x972,0x927,0x8dd,0x894,0x84c,0x805,0x7c0,
0x77b,0x738,0x6f6,0x6b5,0x676,0x637,0x5fa,0x5be,
0x583,0x549,0x511,0x4d9,0x4a3,0x46e,0x43a,0x407,
0x3d6,0x3a6,0x377,0x349,0x31c,0x2f1,0x2c6,0x29d,
0x276,0x24f,0x22a,0x205,0x1e2,0x1c1,0x1a0,0x181,
0x163,0x146,0x12a,0x110,0xf6,0xde,0xc8,0xb2,
0x9e,0x8b,0x79,0x68,0x59,0x4b,0x3e,0x32,
0x27,0x1e,0x16,0xf,0xa,0x6,0x2,0x1,
0x0,0x1,0x2,0x6,0xa,0xf,0x16,0x1e,
0x27,0x32,0x3e,0x4b,0x59,0x68,0x79,0x8b,
0x9e,0xb2,0xc8,0xde,0xf6,0x110,0x12a,0x146,
0x163,0x181,0x1a0,0x1c1,0x1e2,0x205,0x22a,0x24f,
0x276,0x29d,0x2c6,0x2f1,0x31c,0x349,0x377,0x3a6,
0x3d6,0x407,0x43a,0x46e,0x4a3,0x4d9,0x511,0x549,
0x583,0x5be,0x5fa,0x637,0x676,0x6b5,0x6f6,0x738,
0x77b,0x7c0,0x805,0x84c,0x894,0x8dd,0x927,0x972,
0x9be,0xa0c,0xa5a,0xaaa,0xafb,0xb4d,0xba0,0xbf5,
0xc4a,0xca1,0xcf8,0xd51,0xdab,0xe06,0xe62,0xebf,
0xf1d,0xf7c,0xfdd,0x103e,0x10a1,0x1105,0x1169,0x11cf,
0x1236,0x129e,0x1307,0x1371,0x13dc,0x1448,0x14b5,0x1523,
0x1592,0x1603,0x1674,0x16e6,0x1759,0x17ce,0x1843,0x18b9,
0x1930,0x19a9,0x1a22,0x1a9c,0x1b17,0x1b94,0x1c11,0x1c8f,
0x1d0e,0x1d8e,0x1e0f,0x1e91,0x1f14,0x1f97,0x201c,0x20a2,
0x2128,0x21b0,0x2238,0x22c2,0x234c,0x23d7,0x2463,0x24f0,
0x257d,0x260c,0x269b,0x272c,0x27bd,0x284f,0x28e2,0x2976,
0x2a0a,0x2aa0,0x2b36,0x2bcd,0x2c65,0x2cfd,0x2d97,0x2e31,
0x2ecc,0x2f68,0x3004,0x30a2,0x3140,0x31df,0x327e,0x331f,
0x33c0,0x3462,0x3504,0x35a8,0x364c,0x36f0,0x3796,0x383c,
0x38e3,0x398a,0x3a33,0x3adb,0x3b85,0x3c2f,0x3cda,0x3d86,
0x3e32,0x3ede,0x3f8c,0x403a,0x40e8,0x4198,0x4248,0x42f8,
0x43a9,0x445b,0x450d,0x45c0,0x4673,0x4727,0x47db,0x4890,
0x4946,0x49fc,0x4ab2,0x4b69,0x4c21,0x4cd9,0x4d91,0x4e4a,
0x4f04,0x4fbe,0x5078,0x5133,0x51ef,0x52aa,0x5367,0x5423,
0x54e0,0x559e,0x565c,0x571a,0x57d9,0x5898,0x5958,0x5a17,
0x5ad8,0x5b98,0x5c59,0x5d1a,0x5ddc,0x5e9e,0x5f60,0x6023,
0x60e6,0x61a9,0x626c,0x6330,0x63f4,0x64b8,0x657d,0x6642,
0x6707,0x67cc,0x6892,0x6958,0x6a1e,0x6ae4,0x6baa,0x6c71,
0x6d38,0x6dfe,0x6ec6,0x6f8d,0x7054,0x711c,0x71e4,0x72ac,
0x7374,0x743c,0x7504,0x75cd,0x7695,0x775e,0x7826,0x78ef,
0x79b8,0x7a81,0x7b49,0x7c12,0x7cdb,0x7da4,0x7e6d,0x7f36};

uint16_t sineTable2[2048] = { 0 };
/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_DMA_Init(void);
static void MX_SAI1_Init(void);
void StartDefaultTask(void const * argument);

/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* USER CODE BEGIN 0 */

/* USER CODE END 0 */

int main(void)
{

  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration----------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* Configure the system clock */
  SystemClock_Config();

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_DMA_Init();
  MX_SAI1_Init();

  /* USER CODE BEGIN 2 */
  for(int i = 0; i < 1024; i++){
      sineTable2[i * 2] = sineTable[i];
  } 
  HAL_SAI_Transmit_DMA(&hsai_BlockA1, (uint8_t*)sineTable, 1024);
  /* USER CODE END 2 */

  /* USER CODE BEGIN RTOS_MUTEX */
  /* add mutexes, ... */
  /* USER CODE END RTOS_MUTEX */

  /* USER CODE BEGIN RTOS_SEMAPHORES */
  /* add semaphores, ... */
  /* USER CODE END RTOS_SEMAPHORES */

  /* USER CODE BEGIN RTOS_TIMERS */
  /* start timers, add new ones, ... */
  /* USER CODE END RTOS_TIMERS */

  /* Create the thread(s) */
  /* definition and creation of defaultTask */
  osThreadDef(defaultTask, StartDefaultTask, osPriorityNormal, 0, 128);
  defaultTaskHandle = osThreadCreate(osThread(defaultTask), NULL);

  /* USER CODE BEGIN RTOS_THREADS */
  /* add threads, ... */
  /* USER CODE END RTOS_THREADS */

  /* USER CODE BEGIN RTOS_QUEUES */
  /* add queues, ... */
  /* USER CODE END RTOS_QUEUES */
 

  /* Start scheduler */
  osKernelStart();
  
  /* We should never get here as control is now taken by the scheduler */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {
  /* USER CODE END WHILE */

  /* USER CODE BEGIN 3 */

  }
  /* USER CODE END 3 */

}

/** System Clock Configuration
*/
void SystemClock_Config(void)
{

  RCC_OscInitTypeDef RCC_OscInitStruct;
  RCC_ClkInitTypeDef RCC_ClkInitStruct;
  RCC_PeriphCLKInitTypeDef PeriphClkInitStruct;

  __PWR_CLK_ENABLE();

  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
  RCC_OscInitStruct.HSEState = RCC_HSE_ON;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 360;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 4;
  HAL_RCC_OscConfig(&RCC_OscInitStruct);

  HAL_PWREx_ActivateOverDrive();

  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_SYSCLK|RCC_CLOCKTYPE_PCLK1
                              |RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;
  HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5);

  PeriphClkInitStruct.PeriphClockSelection = RCC_PERIPHCLK_SAI_PLLSAI;
  PeriphClkInitStruct.PLLSAI.PLLSAIN = 197;
  PeriphClkInitStruct.PLLSAI.PLLSAIQ = 4;
  PeriphClkInitStruct.PLLSAIDivQ = 1;
  HAL_RCCEx_PeriphCLKConfig(&PeriphClkInitStruct);

}

/* SAI1 init function */
void MX_SAI1_Init(void)
{

  hsai_BlockA1.Instance = SAI1_Block_A;
  hsai_BlockA1.Init.Protocol = SAI_FREE_PROTOCOL;
  hsai_BlockA1.Init.AudioMode = SAI_MODEMASTER_TX;
  hsai_BlockA1.Init.DataSize = SAI_DATASIZE_16;
  hsai_BlockA1.Init.FirstBit = SAI_FIRSTBIT_MSB;
  hsai_BlockA1.Init.ClockStrobing = SAI_CLOCKSTROBING_RISINGEDGE;
  hsai_BlockA1.Init.Synchro = SAI_ASYNCHRONOUS;
  hsai_BlockA1.Init.OutputDrive = SAI_OUTPUTDRIVE_DISABLED;
  hsai_BlockA1.Init.NoDivider = SAI_MASTERDIVIDER_ENABLED;
  hsai_BlockA1.Init.FIFOThreshold = SAI_FIFOTHRESHOLD_EMPTY;
  hsai_BlockA1.Init.ClockSource = SAI_CLKSOURCE_PLLSAI;
  hsai_BlockA1.Init.AudioFrequency = SAI_AUDIO_FREQUENCY_96K;
  hsai_BlockA1.FrameInit.FrameLength = 64;
  hsai_BlockA1.FrameInit.ActiveFrameLength = 32;
  hsai_BlockA1.FrameInit.FSDefinition = SAI_FS_CHANNEL_IDENTIFICATION;
  hsai_BlockA1.FrameInit.FSPolarity = SAI_FS_ACTIVE_HIGH;
  hsai_BlockA1.FrameInit.FSOffset = SAI_FS_FIRSTBIT;
  hsai_BlockA1.SlotInit.FirstBitOffset = 16;
  hsai_BlockA1.SlotInit.SlotSize = SAI_SLOTSIZE_32B;
  hsai_BlockA1.SlotInit.SlotNumber = 2;
  hsai_BlockA1.SlotInit.SlotActive = 0xFFFF0000;
  HAL_SAI_Init(&hsai_BlockA1);

  hsai_BlockB1.Instance = SAI1_Block_B;
  hsai_BlockB1.Init.Protocol = SAI_FREE_PROTOCOL;
  hsai_BlockB1.Init.AudioMode = SAI_MODESLAVE_RX;
  hsai_BlockB1.Init.DataSize = SAI_DATASIZE_24;
  hsai_BlockB1.Init.FirstBit = SAI_FIRSTBIT_MSB;
  hsai_BlockB1.Init.ClockStrobing = SAI_CLOCKSTROBING_RISINGEDGE;
  hsai_BlockB1.Init.Synchro = SAI_SYNCHRONOUS;
  hsai_BlockB1.Init.OutputDrive = SAI_OUTPUTDRIVE_DISABLED;
  hsai_BlockB1.Init.FIFOThreshold = SAI_FIFOTHRESHOLD_EMPTY;
  hsai_BlockB1.FrameInit.FrameLength = 64;
  hsai_BlockB1.FrameInit.ActiveFrameLength = 32;
  hsai_BlockB1.FrameInit.FSDefinition = SAI_FS_STARTFRAME;
  hsai_BlockB1.FrameInit.FSPolarity = SAI_FS_ACTIVE_LOW;
  hsai_BlockB1.FrameInit.FSOffset = SAI_FS_FIRSTBIT;
  hsai_BlockB1.SlotInit.FirstBitOffset = 0;
  hsai_BlockB1.SlotInit.SlotSize = SAI_SLOTSIZE_32B;
  hsai_BlockB1.SlotInit.SlotNumber = 1;
  hsai_BlockB1.SlotInit.SlotActive = 0x00010000;
  HAL_SAI_Init(&hsai_BlockB1);

}

/** 
  * Enable DMA controller clock
  */
void MX_DMA_Init(void) 
{
  /* DMA controller clock enable */
  __DMA2_CLK_ENABLE();

  /* DMA interrupt init */
  HAL_NVIC_SetPriority(DMA2_Stream4_IRQn, 5, 0);
  HAL_NVIC_EnableIRQ(DMA2_Stream4_IRQn);
  HAL_NVIC_SetPriority(DMA2_Stream1_IRQn, 5, 0);
  HAL_NVIC_EnableIRQ(DMA2_Stream1_IRQn);

}

/** Configure pins as 
        * Analog 
        * Input 
        * Output
        * EVENT_OUT
        * EXTI
*/
void MX_GPIO_Init(void)
{

  /* GPIO Ports Clock Enable */
  __GPIOE_CLK_ENABLE();
  __GPIOH_CLK_ENABLE();

}

/* USER CODE BEGIN 4 */

/* USER CODE END 4 */

/* StartDefaultTask function */
void StartDefaultTask(void const * argument)
{

  /* USER CODE BEGIN 5 */
  /* Infinite loop */
  for(;;)
  {
    osDelay(1);
  }
  /* USER CODE END 5 */ 
}

#ifdef USE_FULL_ASSERT

/**
   * @brief Reports the name of the source file and the source line number
   * where the assert_param error has occurred.
   * @param file: pointer to the source file name
   * @param line: assert_param error line source number
   * @retval None
   */
void assert_failed(uint8_t* file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
    ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */

}

#endif

/**
  * @}
  */ 

/**
  * @}
*/ 

/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
